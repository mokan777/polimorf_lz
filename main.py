'''вам необходимо написать класс который будет обрабатывать полученный датасет 
разделять его на два датасета по признаку:"дата оплаты" и сохранять как два 
отдельных файла (до 2014 года и после)так же реализуйте полиморфизм любого 
унарного (один аргумент используется) оператора для удаления дубликатов в датасете
и выведите количество удаленых дубликатов '''

'''вам необходимо написать класс который будет обрабатывать полученый 
датасет: проверять его наличие в дириктории пытаться открыть свериться с ожидаемой 
структурой и выдать сообщение  если все успешно выполнилось в противном случае
обработать с помощью исключений все возникшие ошибки сопроводив каждую из них понятным сообщением об ошибке'''

from processor import DatasetProcessor

if __name__ == "__main__":
    processor = DatasetProcessor("var7.csv")
    
    # 1. Загрузка и валидация данных
    if processor.validate_and_load():
        # 2. Удаление дубликатов (полиморфизм через оператор ~)
        ~processor  
        processor.show_removed_count()
        
        # 3. Разделение данных по дате
        processor.split_by_date()
    else:
        print("Не удалось загрузить данные. Проверьте ошибки выше.")